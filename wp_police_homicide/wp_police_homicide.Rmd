---
title: "WP_Police_Homicides"
author: "Bridget Shaela Robert Sydney"
date: "2023-10-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# turn off sci notation
options(scipen=999)
#load libraries
library(tidyverse)
library(lubridate)
library(refinr)

```

```{r}
homicide_data<-read_csv("data/homicide-data.csv")
```
```{r}
###this code is to get an overview of the data in the data frame
summary(homicide_data)
colnames(homicide_data)
```
```{r}
#the reported_date is a number. We will use lubridate to turn it into a date. 
homicide_data <- homicide_data|>
  mutate(reported_date=ymd(reported_date))
head(homicide_data)

```
```{r}
#creating a new column for the year
yearly_homicide_data <-homicide_data|>
mutate(
  reported_year = case_when(
        str_detect(reported_date, '2007') ~ 2007,
        str_detect(reported_date, '2008') ~ 2008,
        str_detect(reported_date, '2009') ~ 2009,
        str_detect(reported_date, '2010') ~ 2010,
        str_detect(reported_date, '2011') ~ 2011,
        str_detect(reported_date, '2012') ~ 2012,
        str_detect(reported_date, '2013') ~ 2013,
        str_detect(reported_date, '2014') ~ 2014,
        str_detect(reported_date, '2015') ~ 2015,
        str_detect(reported_date, '2016') ~ 2016, 
        str_detect(reported_date, '2017')~  2017,
        .default = NA
      )
  )
```

```{r}
#creating a dataframe for all homicides in Baltimore 
baltimore_homicide <- yearly_homicide_data |>
  filter(city == 'Baltimore')

```


####"As Baltimore has seen a stunning surge of violence, with nearly a killing each day for the past three years in a city of 600,000, homicide arrests have plummeted." (A killing each day for three straight years = 1,095 killings)

```{r}
#Here we are calculating the # of homicides per year. 
 baltimore_homicide |>
  group_by(reported_year)|>
  summarise(count_homicides =n())|>
  arrange(reported_year)
```
### total deaths over the past 3 years (2015, 2016, and 2017) was 1002 (342+320+340) . That is almost 1095 (a killing each day)

```{r}
#checking the number of homicides divided by the number of days in the past 3 years. 
1002/(365*3)

```
###Context: Washington Post writes "...homicide arrests have plummeted. City police made an arrest in 41 percent of homicides in 2014; last year, the rate was just 27 percent, a 14 percentage point drop." We want to check this fact with the following code blocks. First we will check to see if the above mentioned arrest rates are correct. Then we will check to see if arrest rates have fallen since over the past three years (2015, 2016, and 2017). 

```{r}
###calculating the number of homicides in 2014, 2015, 2016, and 2017
baltimore_homicide|>
  filter(reported_year >= '2014')|> 
  group_by(reported_year)|>
  summarise(count_homicides =n())

```
###Answer: there were 211 homicides in Baltimore in 2014. 
```{r}
#counting the number of arrests made that closed open homicide cases in 2014. 
baltimore_homicide|>
  filter(reported_year >= '2014')|>
  filter(disposition == 'Closed by arrest')|>
  group_by(reported_year)|>
  summarise(count_arrests = n())
```
###There were 86 homicide cases closed by arrest in 2014. 

```{r}
#dividing total arrests by total homicides
86/211

```
###Answer: The Washington Post correctly calculated the arrest rate for homicides in the city of Baltimore in 2014 as 40.75 or roughly 41%. Now lets calcualte the arrest rate for homicides in 2017. Was it really 27% as mentioned in the Washington Post article? 

```{r}
#counting total homicides in 2017
baltimore_homicide|>
  filter(reported_date >'2016-12-31')|>
  filter(reported_date <'2018-01-01')|>
  summarise(count_homicides = n())

```

###Answer:There were 340 homicides in Baltimore in 2017. 

```{r}
#counting total homicide cases closed by arrest in 2017
baltimore_homicide|>
  filter(reported_date > '2016-12-31')|>
  filter(reported_date <'2018-01-01')|>
  filter(disposition == 'Closed by arrest')|>
  summarise(count_arrests = n())
```
###Answer. There were 93 homicide cases closed by arrest in 2017. 

```{r}
#dividing total arrests by total homicides
93/340
```
###Answer: Yes, the arrest rate for homicides in Baltimore in 2017 was 27.35 or roughly 27%. Now we want to see if homicide arrest rates plumeted over 2015 and 2015 as well. So we will calculate those. 


```{r}
#counting total homicides in 2016
baltimore_homicide|>
  filter(reported_date >'2015-12-31')|>
  filter(reported_date <'2017-01-01')|>
  summarise(count_homicides = n())
```
###There were 320 homicides in Baltimore in 2016. 

```{r}
#counting total homicide cases closed by arrest in 2016
baltimore_homicide|>
  filter(reported_date >'2015-12-31')|>
  filter(reported_date <'2017-01-01')|>
  filter(disposition == 'Closed by arrest')|>
  summarise(count_arrests = n())
```
###There were 72 homicide cases closed by arrest in 2016

```{r}
72/320
```

###Anser: the arrest rate in 2016 was roughly 23%. That is lower than 2014's homicide arrest rate. Now we will check for 2015. 

```{r}
#counting total homicides in 2015
baltimore_homicide|>
  filter(reported_date >'2014-12-31')|>
  filter(reported_date <'2016-01-01')|>
  summarise(count_homicides = n())
```
###There were 342 homicides repored in Baltimore in 2015

```{r}
#counting total homicide cases closed by arrest in 2015
baltimore_homicide|>
  filter(reported_date >20141231)|>
  filter(reported_date <20160101)|>
  filter(disposition == 'Closed by arrest')|>
  summarise(count_arrests = n())
```
### There were 342 homicides in Baltimore in 2015. The police closed 87 of those cases by arresting someone. Now we need to see the arrest rate. 
```{r}
87/342

```
### Answer: The arrest rate in 2015 was 25%. So in verifying the statement 

###"As Baltimore has seen a stunning surge of violence, with nearly a killing each day for the past three years in a city of 600,000, homicide arrests have plummeted. City police made an arrest in 41 percent of homicides in 2014; last year, the rate was just 27 percent, a 14 percentage point drop."

###We have reviewed the data and found that, yes Baltimore had a arrest rate in 2014 of roughly 41% is correct. Arrest rates plummetted in the three years mentioned -2015, 2016, 2017 - with arrest rates at 25%, 23%, and 27% respectively. 

```{r}
#creating a dataframe that calculates homicides per city in 2014 
city_homicide_2014 <- yearly_homicide_data |>
  filter(reported_year == '2014')|>
  group_by(city)|>
   summarise(count_homicides = n())|>
  arrange(desc(count_homicides))
```

```{r}
#creating a dataframe that calculate closed by arrest per city in 2014
city_closed_2014 <- yearly_homicide_data |>
  filter(reported_year == '2014')|>
  group_by(city) |>
  summarise(cases_closed = n()) |>
  arrange(desc(cases_closed))
```

```{r}
#creating a dataframe that calculates homicides per city in 2017
city_homicide_2017 <- yearly_homicide_data|>
  filter(reported_year == '2017')|>
  group_by(city)|>
  summarise(count_homicides = n())|>
  arrange(desc(count_homicides))


```


```{r}
#creating a dataframe that calculates cases closed by arrest per city in 2017 
city_closed_2017 <- yearly_homicide_data |>
  filter(reported_year == '2017')|>
  group_by(city)|>
  summarise(cases_closed =n())|>
  arrange(desc(cases_closed))
```



